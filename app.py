import streamlit as st
import pandas as pd

# рдкреЗрдЬ рд╕реЗрдЯрд┐рдВрдЧ
st.set_page_config(page_title="рдорддрджрд╛рд░ рд╢реЛрдз рдкреНрд░рдгрд╛рд▓реА", layout="wide")

# рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдгреЗ
@st.cache_data
def load_data():
    df = pd.read_csv('voter_list_combined.csv')
    return df

df = load_data()

st.title("ЁЯФН рдорддрджрд╛рд░ рдпрд╛рджреА рд╢реЛрдз рдкреНрд░рдгрд╛рд▓реА")
st.markdown("---")

# рд╕рд░реНрдЪ рдмрд╛рд░ рдЖрдгрд┐ рдлрд┐рд▓реНрдЯрд░
col1, col2 = st.columns([2, 1])

with col1:
    search_query = st.text_input("рдорддрджрд╛рд░рд╛рдЪреЗ рдирд╛рд╡ рдХрд┐рдВрд╡рд╛ рдХрд╛рд░реНрдб рдирдВрдмрд░ рдЯрд╛рдХрд╛:", placeholder="рдЙрджрд╛. рдирд╛рд╡ рдХрд┐рдВрд╡рд╛ SZHXXXXXXX")

with col2:
    part_filter = st.selectbox("рдпрд╛рджреАрднрд╛рдЧ рдХреНрд░. рдирд┐рд╡рдбрд╛:", ["рд╕рд░реНрд╡"] + sorted(df['рдпрд╛рджреАрднрд╛рдЧ рдХреНрд░.'].unique().tolist()))

# рд╕рд░реНрдЪ рд▓реЙрдЬрд┐рдХ
if search_query:
    filtered_df = df[
        df['рдирд╛рд╡'].str.contains(search_query, case=False, na=False) | 
        df['рдорддрджрд╛рд░ рдХрд╛рд░реНрдб'].str.contains(search_query, case=False, na=False)
    ]
else:
    filtered_df = df

if part_filter != "рд╕рд░реНрд╡":
    filtered_df = filtered_df[filtered_df['рдпрд╛рджреАрднрд╛рдЧ рдХреНрд░.'] == part_filter]

# рдирд┐рдХрд╛рд▓ рджрд╛рдЦрд╡рдгреЗ
st.write(f"рдПрдХреВрдг рд╕рд╛рдкрдбрд▓реЗрд▓реЗ рдорддрджрд╛рд░: **{len(filtered_df)}**")

if not filtered_df.empty:
    # рдореЛрдмрд╛рдИрд▓рд╡рд░ рдкрд╛рд╣рдгреНрдпрд╛рд╕рд╛рдареА рдЯреЗрдмрд▓ рдРрд╡рдЬреА рдХрд╛рд░реНрдб рд╡реНрд╣реНрдпреВ (Optional) рдХрд┐рдВрд╡рд╛ рдиреАрдЯ рдорд╛рдВрдбрдгреА рдХреЗрд▓реЗрд▓реЗ рдЯреЗрдмрд▓
    st.dataframe(filtered_df[['рдЕ.рдХреНрд░', 'рдпрд╛рджреАрднрд╛рдЧ рдХреНрд░.', 'рдорддрджрд╛рд░ рдХрд╛рд░реНрдб', 'рдирд╛рд╡', 'рд╡рдп', 'рд▓рд┐рдВрдЧ']], use_container_width=True)
else:
    st.error("рдорд╛рд╣рд┐рддреА рд╕рд╛рдкрдбрд▓реА рдирд╛рд╣реА. рдХреГрдкрдпрд╛ рдирд╛рд╡ рддрдкрд╛рд╕рд╛.")

st.sidebar.info("рд╣реЗ ре▓рдк релрежрекреж рдорддрджрд╛рд░рд╛рдВрдЪреНрдпрд╛ рдбреЗрдЯрд╛рд╡рд░ рдЖрдзрд╛рд░рд┐рдд рдЖрд╣реЗ.")
